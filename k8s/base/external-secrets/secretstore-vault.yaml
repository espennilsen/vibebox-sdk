---
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: vibebox-vault-secretstore
  namespace: default
spec:
  provider:
    vault:
      server: "https://vault.example.com"  # Change to your Vault server URL
      path: "secret"  # KV v2 mount path
      version: "v2"  # KV version (v1 or v2)
      auth:
        # Option 1: Kubernetes auth (recommended)
        kubernetes:
          mountPath: "kubernetes"
          role: "vibebox-app"
          serviceAccountRef:
            name: vibebox-external-secrets
        # Option 2: Token auth
        # tokenSecretRef:
        #   name: vault-token
        #   key: token

---
# ClusterSecretStore for use across all namespaces
apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: vibebox-vault-cluster-secretstore
spec:
  provider:
    vault:
      server: "https://vault.example.com"
      path: "secret"
      version: "v2"
      auth:
        kubernetes:
          mountPath: "kubernetes"
          role: "vibebox-app"
          serviceAccountRef:
            name: vibebox-external-secrets
            namespace: default
